<?xml version="1.0" encoding="UTF-8"?>
<configuration>

 	<!-- Default config and other properties -->
 	<include resource="org/springframework/boot/logging/logback/defaults.xml"/>
	
	<appender name="local-stdout" class="ch.qos.logback.core.ConsoleAppender">
		<encoder>
			<pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} %boldRed(%5level) %green(%X{HEADER_TRANSACTION}) %blue(%logger{36}.%M l:%3L) %magenta(%msg) %throwable %n</pattern>
			<charset>utf8</charset>
		</encoder>
	</appender>

	<appender name="server-dev-stdout" class="ch.qos.logback.core.ConsoleAppender">
		<encoder>
			<pattern>{"timeStamp":"%d{yyyy-MM-dd HH:mm:ss.SSS}", "level":"%level", "idTransaccion":"%X{HEADER_TRANSACTION}", "class": "%class{36}", "method": "%method", "line":"%line", "message":"%replace(%message){'"', '\\"'}", "throws":"%replace(%throwable){'"', '\\"'}"},%n</pattern>
			<charset>utf8</charset>
		</encoder>
	</appender>
	
	<appender name="server-stdout" class="ch.qos.logback.core.ConsoleAppender">
		<encoder>
			<pattern>{"timeStamp":"%d{yyyy-MM-dd HH:mm:ss.SSS}", "level":"%level", "idTransaccion":"%X{HEADER_TRANSACTION}", "logger":"%logger{18}", "message":"%replace(%message){'"', '\\"'}", "throws":"%replace(%throwable){'"', '\\"'}"},%n</pattern>
			<charset>utf8</charset>
		</encoder>
	</appender>

 	<appender name="file-appender" class="ch.qos.logback.core.rolling.RollingFileAppender">
 		<encoder>
 			<pattern>${FILE_LOG_PATTERN}</pattern>
 			<charset>utf8</charset>
 		</encoder>
 		<file>${LOG_FILE}</file>
 		<rollingPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">
 			<fileNamePattern>${LOG_FILE}.%d.%i.log.gz</fileNamePattern>
			<maxFileSize>10MB</maxFileSize>
			<totalSizeCap>1GB</totalSizeCap>
			<maxHistory>20</maxHistory>
 		</rollingPolicy>
 	</appender>

 	<!-- Profile independent loggers -->
 	<logger name="com.enagas.msc" level="DEBUG"/>
 	<logger name="org.springframework" level="INFO"/>

 	<!-- Local profile -->
	<springProfile name="local">
		<logger name="com.enagas.msc" level="DEBUG" additivity="false">
			<appender-ref ref="local-stdout"/>
			<appender-ref ref="file-appender"/>
		</logger>
		<logger name="com.enagas" level="TRACE" additivity="false">
			<appender-ref ref="local-stdout" />
			<appender-ref ref="file-appender"/>
		</logger>
		<logger name="com.enagas.arch.loginterceptor" level="ALL" additivity="true">
			<appender-ref ref="local-stdout" />
			<appender-ref ref="file-appender"/>
		</logger>
	</springProfile> 	 	

 	<!-- Development/Staging/production profile -->
	<springProfile name="dev | development | mig | pre">
	 	<root level="ERROR">
 			<appender-ref ref="server-dev-stdout"/>
 		</root>
		
    	<logger name="org.hibernate.SQL" level="DEBUG" additivity="false">
    		<appender-ref ref="server-dev-stdout"/>
    	</logger>
	
 		<logger name="com.enagas.msc" level="DEBUG" additivity="false">
			<appender-ref ref="server-dev-stdout"/>
		</logger>
		<logger name="com.enagas" level="TRACE" additivity="false">
			<appender-ref ref="server-dev-stdout"/>
		</logger>
		<logger name="com.enagas.arch.loginterceptor" level="ALL" additivity="true">
			<appender-ref ref="server-dev-stdout"/>
		</logger>
 	</springProfile>
 	
 	<springProfile name="default">
 		<root level="ERROR">
 			<appender-ref ref="server-stdout"/>
 		</root>
 	 	
 	    <logger name="org.hibernate.SQL" level="DEBUG" additivity="false">
    		<appender-ref ref="server-stdout"/>
    	</logger> 	
 		<logger name="com.enagas.msc" level="DEBUG" additivity="false">
			<appender-ref ref="server-stdout"/>
		</logger>
		<logger name="com.enagas" level="INFO" additivity="false">
			<appender-ref ref="server-stdout"/>
		</logger>
		<logger name="com.enagas.arch.loginterceptor" level="ALL" additivity="true">
			<appender-ref ref="server-stdout"/>
		</logger>
 	</springProfile>
 	
</configuration>